# 第三轮优化报告（ChestMNIST）

## 目标
基于第二轮结果，重点提升加密的扩散能力与鲁棒指纹验证，同时探索ROI无损压缩的结构化编码。

## 本轮改动
- **二维交替扩散**：在混沌排列后，加入行、列双向扩散，并进行动态密钥更新（key ← key + prev / nextv）。显著提升扩散强度。
- **零水印指纹**：从 DWT-LL 低频块的均值相对全局中位数生成64位指纹（不嵌入、不改图），做鲁棒比对。
- **结构化无损编码**：对 IWT 子带采用简单零游程 RLE + zlib 压缩，观察与PNG的对比。

## 数据与设置
- 数据集：ChestMNIST（600张真实胸片）。
- 鲁棒性测试：对明文进行JPEG重编码（Q=95）后加解密，进行指纹比对。
- 链上：默认本地内存链登记首张样本，保持真实流程打通。

## 关键结果
- ROI无损重构：平均 PSNR=100.00，SSIM=1.0000。
- 加密扩散能力：
  - **NPCR**：≈ 99.60%（接近理想值）；
  - **UACI**：≈ 33.49%（达到常见安全标准）。
- 密文熵：≈ 7.74 bits（直方图近均匀）。
- 指纹鲁棒性：
  - pHash（明文JPEG重编码后）：平均汉明距离 ≈ 25.04；
  - **零水印（DWT-LL）**：平均汉明距离 ≈ 32.01（范围 20–46）。
  - 结论：胸片低频结构对JPEG重编码极为敏感，零水印与pHash都会出现较大距离；需引入纠错编码（例如BCH/RS）降低误判率。
- ROI无损压缩：
  - IWT RLE+zlib 平均字节 ≈ 1063；
  - ROI PNG 平均字节 ≈ 749；
  - 结论：当前简单RLE策略不足，需对IWT系数进行**差分+符号分离+RLE+熵编码**的联合设计，预计可优于PNG。

## 问题分析与下一步
1. **指纹鲁棒性不足**：
   - 采用 DWT 低频块均值阈值仍对JPEG重编码敏感。
   - 下一步：块级符号序列 + BCH/RS 纠错编码；或对局部对比度归一化后取符号。
2. **结构化无损压缩不足**：
   - 简单RLE难以充分利用系数统计结构。
   - 下一步：LL做差分与熵编码，高频子带做零块检测与RLE，整体用算术编码。

## 结论
本轮在 ChestMNIST 上实现了**二维交替扩散**，使加密扩散指标达到安全标准（NPCR≈99.6%、UACI≈33.5%）；零水印指纹与pHash在JPEG重编码下距离较大，需引入纠错以提高鲁棒确权；结构化无损编码仍待增强。下一轮计画将聚焦指纹纠错与系数编码。

